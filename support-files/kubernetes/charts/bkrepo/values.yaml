# Default values for bkrepo.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

replicaCount: 1

image:
  repository: bkrepo.com/bkrepo
  pullPolicy: IfNotPresent
  # Overrides the image tag whose default is the chart appVersion.
  tag: ""

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

serviceAccount:
  # Specifies whether a service account should be created
  create: false
  # Annotations to add to the service account
  annotations: {}
  # The name of the service account to use.
  # If not set and create is true, a name is generated using the fullname template
  name: ""

podSecurityContext: {}
  # fsGroup: 2000

securityContext: {}
  # capabilities:
  #   drop:
  #   - ALL
  # readOnlyRootFilesystem: true
  # runAsNonRoot: true
  # runAsUser: 1000

resources: {}
  # We usually recommend not to specify default resources and to leave this as a conscious
  # choice for the user. This also increases chances charts run on environments with little
  # resources, such as Minikube. If you do want to specify resources, uncomment the following
  # lines, adjust them as necessary, and remove the curly braces after 'resources:'.
  # limits:
  #   cpu: 100m
  #   memory: 128Mi
  # requests:
  #   cpu: 100m
  #   memory: 128Mi

tolerations: []

affinity: {}

# ingress
ingress:
  enabled: true

# ingress-nginx
ingress-nginx:
  # false则忽略ingress-nginx部署
  enabled: true
  controller:
    kind: DaemonSet
    admissionWebhooks:
      enabled: false

# volume
volume:
  # nfs存储
  nfs:
    # false则使用hostPath模式
    enabled: false
    path: /data/nfs/
    server: 10.0.1.3
  # 使用host存储，多host无法共享目录，供单机部署测试使用
  hostPath:
    path: /data/local
  storage: 10Gi

# bkrepo
bkrepo:
  init:
    # 是否初始化mongodb数据，脚本能够幂等执行，第一次必须执行
    mongodb: true
  # 选择需要启动的依赖源registry
  registry:
    docker: false
    helm: false
env:
  # bkrepo 初始化用户名密码
  BK_REPO_USERNAME: admin
  BK_REPO_PASSWORD: blueking
  # gateway网关相关配置
  BK_HTTP_SCHEMA: http
  BK_REPO_HTTP_SCHEMA: http
  BK_REPO_FQDN: bkrepo.com
  BK_REPO_HOST: bkrepo.com
  BK_REPO_UI_HOST: bkrepo.com
  BK_CI_FQDN: bkci.com
  BK_REPO_HTTP_PORT: 80
  BK_REPO_HTTPS_PORT: 443
  BK_REPO_APIGW_URL:
  BK_REPO_APP_CODE:
  BK_REPO_APP_TOKEN:
  BK_REPO_HOME: /data/workspace
  BK_REPO_LOGS_DIR: /data/logs
  BK_REPO_PAAS_FQDN:
  BK_REPO_PAAS_LOGIN_URL:
  BK_REPO_AUTHORIZATION: "Platform MThiNjFjOWMtOTAxYi00ZWEzLTg5YzMtMWY3NGJlOTQ0YjY2OlVzOFpHRFhQcWs4NmN3TXVrWUFCUXFDWkxBa00zSw=="
  BK_REPO_GATEWAY_CORS_ALLOW_LIST:
  # 网关通过dns做服务发现，默认访问k8s-dns服务
  BK_REPO_GATEWAY_DNS_ADDR: local=on
  # 服务名称前缀
  BK_REPO_SERVICE_PREFIX: repo-
  # 部署模式，standalone: 独立模式，ci: 与ci搭配模式
  BK_REPO_DEPLOY_MODE: standalone

  # consul 相关配置
  # consul dns服务地址，格式:consul-dns.$(NAMESPACE).svc.cluster.local
  BK_REPO_CONSUL_DNS_HOST: consul-dns.default.svc.cluster.local
  BK_REPO_CONSUL_DNS_PORT: 53
  # consul http服务地址，格式:consul-server.$(NAMESPACE).svc.cluster.local
  BK_REPO_CONSUL_SERVER_HOST: consul-server.default.svc.cluster.local
  BK_REPO_CONSUL_SERVER_PORT: 8500
  # consul dns服务查询domain，查询格式[tag.]<service>.service[.datacenter].<domain>
  BK_REPO_CONSUL_DOMAIN: consul
  BK_REPO_CONSUL_TAG: bkce

  # 微服务公共配置
  # 文件存储路径
  BK_REPO_FILE_PATH: /data/storage
  # mongodb 标准连接字符串
  BK_REPO_MONGODB_URI: mongodb://127.0.0.1/bkrepo

  # repository服务配置
  BK_REPO_REPOSITORY_PORT: 25901

  # auth服务配置
  BK_REPO_AUTH_PORT: 25902
  BK_REPO_AUTH_REALM: local
  BK_IAM_PRIVATE_URL: http://iam.service.consul:8080
  BK_PAAS_PRIVATE_URL: http://paas.service.consul
  BK_REPO_IAM_CALLBACK_USER:
  BK_REPO_IAM_ENV: prod
  BK_REPO_IAM_HOST: iam.service.consul
  BK_REPO_IAM_HTTP_PORT: 80
  BK_REPO_IAM_IP0: iam.service.consul
  BK_REPO_IAM_TOKEN_URL: /bkiam/api/v1/auth/access-tokens

  # docker api服务配置
  BK_REPO_DOCKERAPI_PORT: 25906
  BK_REPO_DOCKERAPI_REALM: bkrepo
  BK_REPO_DOCKERAPI_HARBOR_URL:
  BK_REPO_DOCKERAPI_HARBOR_USERNAME:
  BK_REPO_DOCKERAPI_HARBOR_PASSWORD:
  BK_REPO_DOCKERAPI_HARBOR_IMAGE_PREFIX:
  BK_SSM_PRIVATE_URL: http://ssm.service.consul

  # generic服务配置
  BK_REPO_GENERIC_PORT: 25801

  # docker服务配置
  BK_REPO_DOCKER_PORT: 25802
  BK_REPO_DOCKER_FQDN: docker.bkrepo.com
  BK_REPO_DOCKER_HOST: docker.bkrepo.com
  BK_REPO_DOCKER_HTTP_PORT: 80
  BK_REPO_DOCKER_HTTPS_PORT: 443
  BK_REPO_DOCKER_CERT_KEY: /data/workspace/certs/cert.key
  BK_REPO_DOCKER_CERT_PEM: /data/workspace/certs/cert.pem

  # maven服务配置
  BK_REPO_MAVEN_PORT: 25803

  # npm服务配置
  BK_REPO_NPM_PORT: 25804

  # pypi服务配置
  BK_REPO_PYPI_PORT: 25805

  # helm服务配置
  BK_REPO_HELM_PORT: 25806
  BK_REPO_HELM_FQDN: helm.bkrepo.com
  BK_REPO_HELM_HTTP_PORT: 80
